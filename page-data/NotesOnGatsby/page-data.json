{"componentChunkName":"component---src-templates-blog-post-js","path":"/NotesOnGatsby/","result":{"data":{"site":{"siteMetadata":{"title":"Notes on Coffee, Books, and Programming"}},"markdownRemark":{"id":"1d8360e1-3814-541a-888d-d61a558ee7f8","excerpt":"Part 1: Gatsby Building Blocks After creating the “hello world” site from the gatsby-cli, there are many such starters that allow you to start with more than…","html":"<h2>Part 1: Gatsby Building Blocks</h2>\n<p>After creating the “hello world” site from the gatsby-cli, there are many such starters that allow you to start with more than nothing, using:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\">gatsby <span class=\"token keyword\">new</span> <span class=\"token punctuation\">[</span><span class=\"token module variable\">SITE_NAME</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token module variable\">GITHUB_URL</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>So we’re creating a new [SITE_NAME] by pulling from the starter located at [GITHUB_URL]</p>\n<hr>\n<h3>Gatsby Page Development</h3>\n<p>With that out of the way, let’s get down to business and look at the websites in a bit more detail. Like any static-site generation software, we know that creating websites using Gatsby must involve some form of programming voodoo to ensure that we get more code out of less, and hopefully some easy way to separate presentation from the data on our website</p>\n<p>For Gatsby, this is done through React! React is a framework created by Facebook for the sakes of simplifying website development through components, which basically serve as a way to compose website elements accordingly. </p>\n<p>To do so, React involves “JSX”, which serves as a way to take HTML and make it into Javascript Fragments. Given all of this, Gatsby will then pull all of these components together into a website via <code class=\"language-text\">gatsby build</code> , which we can then put on the website itself. </p>\n<p>So, as an example from the site, the following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\">import <span class=\"token module variable\">React</span> from <span class=\"token string\">\"react\"</span>\n\nexport default <span class=\"token keyword\">function</span> <span class=\"token module variable\">Home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  return <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token module variable\">Hello</span> world<span class=\"token operator\">!&lt;/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Really does something similar to the following, but with the ability to keep things cleaner in the long run:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\">import <span class=\"token module variable\">React</span> from <span class=\"token string\">\"react\"</span>\n\nexport default <span class=\"token keyword\">function</span> <span class=\"token module variable\">Home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  return <span class=\"token module variable\">React</span><span class=\"token punctuation\">.</span>createElement<span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">,</span> null<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Hello world!\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>Building with components</h3>\n<p>The above function, which is then converted into a real piece of HTML, is called a React <strong>component</strong>. These serve as the building blocks of any website created in React, and, if done right, can lead to a lot of ease with minimal overhead. By composing components into each other, we can create a lot of html out of very little work, so we could have the following website JSX:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\"><span class=\"token operator\">&lt;</span><span class=\"token module variable\">Page</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token module variable\">Header</span><span class=\"token operator\">/></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token module variable\">BlogLayout</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token module variable\">BlogPost</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">}</span><span class=\"token operator\">/></span>\n       <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token operator\">&lt;/</span><span class=\"token module variable\">BlogLayout</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;/</span><span class=\"token module variable\">Page</span><span class=\"token operator\">></span></code></pre></div>\n<p>Unlike standard HTML, React includes so-called “self-closing” tags, which primarily allow us to save time and make for easier layouts, turning something like <code class=\"language-text\">&lt;Button&gt;&lt;/Button&gt;</code> into <code class=\"language-text\">&lt;Button/&gt;</code>. I’ll make use of them for this website, and I encourage all of you to do as well!</p>\n<p>Playing on this feature of React, Gatsby designates each page of the website as its own component in a js file in the <code class=\"language-text\">src/pages</code> directory.  So, I could add an about page to my website using the following code in <code class=\"language-text\">src/pages/about.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\">import <span class=\"token module variable\">React</span> from <span class=\"token string\">\"react\"</span>\n\nexport default <span class=\"token keyword\">function</span> <span class=\"token module variable\">About</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  return <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> color<span class=\"token punctuation\">:</span> <span class=\"token variant variable\">`teal</span>` <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token module variable\">About</span> <span class=\"token module variable\">Gatsby</span><span class=\"token operator\">&lt;/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token module variable\">Such</span> wow<span class=\"token punctuation\">.</span> <span class=\"token module variable\">Very</span> <span class=\"token module variable\">React</span><span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;/</span>p<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>A few last notes of importance before we continue with this high-level overview. </p>\n<ul>\n<li>If you’re familiar with older React versions, it might seem weird that we’re using the less expressive “functional” syntax instead of the more traditional “class-based” syntax. React now has a feature known as “React-Hooks”, which makes functional components easier to use with state, and allow us to have stateful components without some of the pitfalls of Javascript classes. I’d recommend using them, if only to test them out for a bit!</li>\n<li>\n<p>Additionally, as each of these components are functions, it makes sense that we should be able to pass information to them. We can do that by passing stuff similar to attributes, so if we had <code class=\"language-text\">&lt;Header prop1=&quot;LOL&quot;/&gt;</code> , we’re passing\n“LOL” into <code class=\"language-text\">prop1</code> input of our function.</p>\n<ul>\n<li>You can access this anywhere in your React Component via <code class=\"language-text\">props.prop1</code> , or other names</li>\n<li>Additionally, you can also specify the input and then use that to pass it through. I’d choose this approach for most functional argument passing, but the above approach can be useful if you’re trying to do something complex</li>\n</ul>\n<hr>\n</li>\n</ul>\n<h3>Linking between pages</h3>\n<p>Besides traditional <code class=\"language-text\">&lt;a&gt;</code> tags, Gatsby also allows us to use the <code class=\"language-text\">&lt;Link/&gt;</code> tag to dramatic effect in our code. </p>\n<p>As Gatsby is a static-site generator, using <code class=\"language-text\">&lt;Link/&gt;</code> for internal portions of the website and <code class=\"language-text\">&lt;a/&gt;</code> for the external portions of the website will lead to optimal performance,  as it’ll allow Gatsby to make the routing easier and allow your site to look more responsive, preventing some of the times associated with querying the server directly each page change</p>\n<hr>\n<h2>Part 2: Introduction to Styling in Gatsby</h2>\n<p>Obviously, simply using the default styling of the web will lead to a very… unimpressive website. Thus, for any custom styling you might want to use, Gatsby offers a great amount of flexibility. </p>\n<p>Firstly, it offers global styles. These <code class=\"language-text\">.css</code> files serve as generic CSS that can apply to any and all components you make for the website, and are very similar to the traditional way CSS was done on the web. However, unlike standard <code class=\"language-text\">.css</code> files, which simply work when they’re imported into the HTML for a website, these need to work with <code class=\"language-text\">gatsby-browser.js</code>, a file in your base Gatsby directory that helps Gatsby know how to import everything and build it together into a final website.  You do this by simply importing the css file in that file, by adding a line like the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\">import <span class=\"token string\">\"./src/styles/global.css\"</span></code></pre></div>\n<p>Besides global CSS, however, most people generally want some way to create so-called <strong>locally-scoped CSS</strong>, which serves as a way to use similar names for multiple bits of CSS without needing to worry about naming conflicts or weird things happening in different parts of the code. </p>\n<p>To do this in Gatsby, it uses so-called <code class=\"language-text\">CSS Modules</code>. To use them, simply create some CSS in a file with the <code class=\"language-text\">.modules.css</code> extension, rather than the traditional <code class=\"language-text\">.css</code> extension. In doing so, we can then import the CSS module into any component we desire and use them accordingly:</p>\n<div class=\"gatsby-highlight\" data-language=\"ocaml\"><pre class=\"language-ocaml\"><code class=\"language-ocaml\">import localStyles from <span class=\"token string\">\"./blogpost.module.css\"</span>\n\nexport default <span class=\"token keyword\">function</span> <span class=\"token module variable\">Page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   return <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>localStyles<span class=\"token punctuation\">.</span><span class=\"token module variable\">CSSClassName</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So here, we import the CSS Module like we’d import a React component, and then simply pass the className as a prop, and it just works!</p>\n<p>However, for those who liked the idea of removing an additional file, the HTML file, in React, we can go further beyond - we can put even the CSS into the React code itself!</p>\n<p>We can do this through the <code class=\"language-text\">CSS-in-JS</code> approach. This is either done via the Emotion library or the Styled-Components library. While I will not get into detail on them here, the idea is rather simple - just create a wrapper component with some style and stick our current component within it, sort of like a React-nesting doll. These make the development process easy and reliable, so use them to your advantage!</p>\n<hr>\n<h2>Part 3: Creating Nested Layout Components</h2>\n<p>Again -  as the process of building most simple website can be rather tedious, Gatsby uses React to simplify constructing websites. It does this by relying on React’s <strong>compositionality,</strong> by creating outer Layout components and layering them up, building your website bit-by-bit.</p>\n<p>Again, in order to make static site development easier, Gatsby takes this compositionality one step further, through so-called <strong>Gatsby Plugins</strong>. These serve as little bits of code that allow you to get a bit more out of your build process.</p>\n<p>To use them, you’ll do the following:</p>\n<ul>\n<li>npm install the plugin, using whatever command is given to you</li>\n<li>edit the <code class=\"language-text\">gatsby-config.js</code> file, which directs Gatsby to the fact you have a plugin installed, and directs it to any  needed config files</li>\n<li>create and modify the configuration files accordingly, so you get the desired effect</li>\n</ul>\n<p>gatsby-plugin-typography looks like a really nice typography plugin. I might need to check that one out for the actual site.</p>\n<hr>\n<h2>Part 4: Data in Gatsby</h2>\n<p>So so far, we have been working with a lot of the presentational components of a website. Theoretically, you could simply make a website out of these, and then serve it to whoever you want to serve it to. </p>\n<p>However, when any static site gets large enough, React’s simple compositionality can fail. For example, let’s say that you want to create a collection of blogposts, and render all of that for your site.</p>\n<p>You could create a tool that turns all of these posts into JSON, and import that data into your website, but that seems a bit excessive, doesn’t it? If we could simple remove the dependency between our data and our presentational layers, then we could manage our code easier, and simply let Gatsby do our work for us</p>\n<p>After all, we want to be lazy and make nice, readable code. If we had to build our own tools while using a supposed “cure-all”, it’d probably either cost us time, money, or lots and lots of energy</p>\n<p>Luckily, such a thing is not just “possible”, but it is very doable. How? Through Gatsby plugins and its Data API!</p>\n<p>We can do this in two different ways: the <code class=\"language-text\">createPages API</code> to pull in unstructured data into pages directly, which is more recommended for smaller websites, or the GraphQL data layer, which is more recommended for larger websites.</p>\n<p>For the former approach, we can simply edit the gatsby-node.js accordingly to pass in the context:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">exposts<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> actions<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>createPage<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">const</span> data_to_pass_in <span class=\"token operator\">=</span> <span class=\"token function\">call_function_to_get</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>     \n<span class=\"token function\">createpage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">route</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        component<span class=\"token operator\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path_to_source\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        context<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> data_to_pass_in <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>And then, when you’re passing in the data to our React functions, we simply pass the data through the <code class=\"language-text\">pageContext</code> parameter!</p>\n<p>For the latter approach, however, we’ll need to explain quite a bit. So let’s jump in!</p>\n<p>As GraphQL is another whole can of worms to explain, I’ll try to summarize. For more details, the tutorial page goes to the following, and it looks great!</p>\n<p><a href=\"https://www.howtographql.com/\">How to GraphQL - The Fullstack Tutorial for GraphQL</a></p>\n<p> Before we get into it, I want to explain the overall process in more detail:</p>\n<p>First of all, we start by getting the data in some shape / form we can work with. This could be as traditional as a basic SQL database, to stuff like Markdown files for blogposts, machine learning models, and so on. Gatsby considers data to be anything outside of a React component, so anything that feeds into the content of your website, that you think is updateable often enough and is used often enough to separate out, is something that could be considered “data”</p>\n<p>Secondly, we then take in the data and bring it into our site in some way. In Gatsby, this process of bringing data into our website is done through a so-called “source plugin”, which lets us grab data and bring it in as structured data, like an internal database.</p>\n<p>Thirdly, we then take this data, and further warp it using a transformer plugin, which can help ensure that the data is what we desire it to be. </p>\n<p>Lastly, we then query this internal database through GraphQL, which will allow us to grab this data into our components, and build some high-quality components!</p>\n<hr>\n<p>With this process in mind, then, we can now look at an, admittedly simple, but straightforward example. </p>\n<p>Let’s say that we wanted to abstract our title away from our components, allowing us to change it at will or to make it cleaner for another developer to look at. </p>\n<p>To do so, instead of using a Source Plugin or a Transformer Plugin, we’ll plug in our data directly into Gatsby by adding a field to the module.exports section of our site called “siteMetadata”:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    siteMetadata<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n       title<span class=\"token operator\">:</span> <span class=\"token string\">\"Data-driven title\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>With this data now in our system, we can add a query to one of our pages to grab it  using GraphQL. To do so, we’ll need to add an import to the GraphQL library:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span></code></pre></div>\n<p>Then we’ll pass in the data as the “data” parameter to our component:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">About</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then, we’ll need to add a query to the bottom of our file,  as another global object. This is so that we can query our GraphQL data to get our title:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  query {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n  }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>Here, we are querying a general query, then looking at our site’s data in general, then looking for the siteMetadata section in general, and then grabbing the title we wanted. </p>\n<p>From there, then, we can access the data directly in our function like the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>site<span class=\"token punctuation\">.</span>siteMetadata<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span></code></pre></div>\n<p>As you can see, while GraphQL is a bit verbose, it is super easy to tell how the data will come out of it, making it easy to predict how the data will come out and thus speed up development speed.</p>\n<p>Queries created in this manner only work on page components, and NOT on the sub-components you want to use them on. You’ll need to use the “useStaticQuery” hook to grab the data, but it’s the same process in the end.</p>\n<hr>\n<h2>Part 5: Source Plugins</h2>\n<p>With the basics of GraphQL over with, let’s go over a tool that helps speedup Gatsby development with GraphQL: GraphiQL. </p>\n<p>If you go to your dev server, and go to route <code class=\"language-text\">/__graphql</code> , you’ll notice that there’s an explorer window. This will let you craft queries, run them to see what data you can pull out of your website, and so on. </p>\n<p>When starting out, it’s a great idea to mess around with data and use this extensively, as this allows us to check our queries and get information out of them without needing to look at the website’s progress.</p>\n<p>With the ability to explore the data you import, we can start using Source plugins. </p>\n<p>As you might recall, Source plugins are the ways Gatsby can import data into the GraphQL system. </p>\n<p>To use them, you import them like any other plugin: Firstly import them via NPM, then add then add the necessary configuration information to gatsby-config. </p>\n<p>After that, the data will be easily visible and usable in the Gatsby system, which you can then access via GraphiQL to generate and process your queries. </p>\n<hr>\n<h2>Part 5: Transformer Plugins</h2>\n<p>While source plugins make data come to us, transformer plugins make that data usable.  Again, the process is really simple, and is like installing any other plugin. Once you install them, the GraphiQL manager will update accordingly, and give you the information you need to turn your data into what you want it to be, like if you wanted to convert a webpage from Markdown to true HTML. </p>\n<p>Transformer plugins do not pull in new data but transform existing data, so remember that you’ll need some filesystem source plugin to use the remark transformer plugin to get HTML out of your markdown blogposts.</p>\n<hr>\n<h2>Part 7: Programmatically create pages from data</h2>\n<p>Now, with most pieces of data, we can probably just import it into a webpage and act accordingly.</p>\n<p>However, for a lot of our data, we’d like methods by which to create webpages dynamically, i.e. without needing to create the route for each and every webpage.</p>\n<p>To do so, we’ll use the “onCreateNode” and the “createPages” APIs, which allow us to take our data, its corresponding routing information, and combine them into a webpage. </p>\n<p>Now, doing this process can seem daunting at first, but it’s totally worth it.</p>\n<p>To create a webpage, we need two pieces of information:</p>\n<ol>\n<li>The slug, or the path information for the webpage in question</li>\n<li>The page itself, including the component we’re rendering and the associated data</li>\n</ol>\n<p>To make the slugs, we’re going to get the data and attach it to the markdown data in our database, in effect augmenting it:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createFilePath <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateNode</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createNodeField <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">MarkdownRemark</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> slug <span class=\"token operator\">=</span> <span class=\"token function\">createFilePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">,</span> basePath<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">pages</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">slug</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      value<span class=\"token operator\">:</span> slug<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here, upon the creation of a reMark node, which signals the creation of the data that contains the information we need, we then grab the sub-information we’ll use for the path, the slug. </p>\n<p>Then, we need to grab the page information and use it to create a page:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    query {\n      allMarkdownRemark {\n        edges {\n          node {\n            fields {\n              slug\n            }\n          }\n        }\n      }\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>allMarkdownRemark<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      path<span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>fields<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">,</span>\n      component<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./src/templates/blog-post.js</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      context<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Data passed to context is available</span>\n        <span class=\"token comment\">// in page queries as GraphQL variables.</span>\n        slug<span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>fields<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So here, we’re first grabbing our slug through a GraphQL query, passing the data to our component, and then letting Gatsby work it’s magic.</p>\n<p>For the actual blog post, then, we simply make our component template:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span>\n<span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/layout\"</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">BlogPost</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>markdownRemark\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Layout</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">dangerouslySetInnerHTML</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> __html<span class=\"token operator\">:</span> post<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Layout</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql`\n  <span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">$slug<span class=\"token operator\">:</span> String<span class=\"token operator\">!</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">markdownRemark</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fields<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> slug<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> eq<span class=\"token operator\">:</span> $slug <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      html\n      frontmatter <span class=\"token punctuation\">{</span>\n        title\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Besides the clear “dangerouslySetInnerHTML” query, which allows us to add HTML directly through a ReMark transformer plugin, notice that we added a GraphQL based on our slug,  which allowed us to get our data programmatically and get the correct blog post as, even though this is a page template, it’s still a page, so we do not need to use the “useStaticQuery” GraphQL plugin. </p>\n<p>But, overall, it’s easy to see that this process will work and allow us to turn data into pages. It’s more complicated than simply generating pages directly, but it allows us to make truly amazing websites really really quickly.</p>\n<hr>\n<h2>Part 8: Preparing a Site to Go Live</h2>\n<p>For live websites, there are obviously some kinds of tests that someone who spends their time on the development side of things may or may not remember to use.</p>\n<p>For this reason, Gatsby’s tutorial ends off with running Lighthouse, which is a web auditing software that gives us an idea as to what sorts of things we can do to make our website better.</p>\n<p>To run the test, we simply use Incognito Mode and the Developer’s Console to run the audit. </p>\n<p>After running the tests, you’ll get scores in 5 categories: Performance, PWA Best Practices, Accessibility, General Best Practices, and SEO (Search Engine Optimization). </p>\n<p>Additionally, it will also give you suggestions as to what to do to improve your skills in these efforts. While these do seem like more work, they make sure your website is the best it can be for all, making it useful and important for anyone using it. </p>\n<p>For Gatsby apps in particular, we’ll need to add some basic configs to ensure that our website does what it needs to do.</p>\n<h3>Adding a Manifest</h3>\n<p>PWAs, or Progressive Web Apps, are hybrid web-app interfaces that allow websites to have app based features and be downloaded onto phones. </p>\n<p>These tend to be highly mobile-friendly sites that users will want to come back to time and time again. </p>\n<p>In order to improve our Lighthouse scores all together, we’ll need to fully turn our website into a PWA. To do so, we’ll need to add a so-called “manifest” file, which serves as a way to tell our website how it can be downloaded. </p>\n<p>To do this in Gatsby, we simple need to add the plugin <code class=\"language-text\">gatsby-plugin-manifest</code> , add a favicon to the path <code class=\"language-text\">src/images/icon.png</code> , and add the needed config info in the <code class=\"language-text\">gatsby-config.js</code> </p>\n<hr>\n<h3>Add offline support</h3>\n<p>Besides the Manifest file, we also need to add a “service worker”, which serves to manage network or cached content accordingly. Without this, our app will not work offline or with partial connectivity, all of which are needed for most mobile users.</p>\n<p>Again, while doing this manually can be challenging, gatsby makes this whole process very very easy. Simply run <code class=\"language-text\">npm install --save gatsby-plugin-offline</code> , and add the config to your gatsby-config system. </p>\n<p>NOTICE: In the config file, you need the offline plugin to be listed <em>after</em> the manifest plugin, so we cache the manifest file and ensure PWA-ness</p>\n<hr>\n<h3>Add page metadata</h3>\n<p>Besides PWA-scores, you can also easily improve your Gatsby SEO scores through React-Helmet, which let’s you manage your document head. </p>\n<p>By configuring it and adding things accordingly, you can add to the layout the needed SEO materials, so that you can configure everything and combine everything together. </p>\n<p>With that done - you’re now familiar enough with Gatsby to start moving forward with it. It’s time to stop reading and get to the main action of any programming endeavor - programming!</p>\n<hr>\n<h2>Post-Usage Notes, or Useful Odds-and-Ends</h2>\n<ul>\n<li>\n<p>If you’re using Gatsby with WSL2, and are NOT getting hot-reloading with Gatsby Develop to work, then you need to do the following to make it work:</p>\n<ol>\n<li>Make sure your project is within the WSL2 portion of the filesystem (Not in /mnt/c…, but in /home!). Additionally, make sure that this is not a symlink, but the actual files located there. </li>\n<li>Additionally, with the augmentation, if you prefer to use VS Code for FullStack development like I do, then you’ll need to  install the Remote Viewing Extension, which lets you peer into your inner VM and use it directly. This lets you get the best of both worlds: A WSL2 Container, ensuring you get perfect coverage and clean Linux code, AND programming with VSCode, which makes it easier for others to look at your process and use it’s plugins ( even if I prefer Vim for most other things… )</li>\n</ol>\n</li>\n<li>\n<p>If you have a webpage, and are trying to do an incremental update of Gatsby code to a certain route, you can do this through the following approach:</p>\n<ol>\n<li>In the gatsby-config.js file, we need to change pathPrefix to the subroute the file will be posted in. This will ensure that all routes include that prefix to them before we use them. </li>\n<li>Instead of building normally, we need to build with <code class=\"language-text\">gatsby build --prefix-paths</code> . This allows us to include these prefixes, and thus ensure that you can make that update easier.</li>\n</ol>\n</li>\n<li>If you’re using dates in Gatsby and trying to get its system to recognize your datetimes as strings, you need to convert to YYYY-MM-DD:TIME format, as otherwise it simply will say you have a string, or something more insiduous. This caused me 2 hours of debugging, so if you get <code class=\"language-text\">&quot;Unknown argument &quot;formatString&quot; on field &quot;date&quot; of type &quot;MarkdownRemarkFrontmatter&quot;</code> when trying to edit a format string, it’s probably a problem with Gatsby more than anything else, and you’ll need to either reformat your dates, which is the easier way, or try to muddle through Gatsby’s type declaration API, something I’m a bit intimidated with tbh. </li>\n</ul>","frontmatter":{"title":"Gatsby Development 101 - A Condensed Tutorial","date":"Jun 07, 2020","description":"A condensed version of the standard Gatsby tutorial"}}},"pageContext":{"slug":"/NotesOnGatsby/","previous":{"fields":{"slug":"/EECS490/24/"},"frontmatter":{"title":"Distributed Computing (EECS490Lec24)"}},"next":{"fields":{"slug":"/IITLA/1/"},"frontmatter":{"title":"Introduction to Information Theory (IITLA 1)"}}}}}